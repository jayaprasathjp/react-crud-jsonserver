function t(){return t=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},t.apply(this,arguments)}class e{constructor(t){this.cache=void 0,this.cache=t}define(t,e){this.cache[t]=e}get(t){return this.cache[t]}remove(t){delete this.cache[t]}reset(){this.cache={}}load(e){this.cache=t({},this.cache,e)}}class n extends Error{constructor(t){super(t),this.name="Eta Error"}}function s(t,e,s){const i=e.slice(0,s).split(/\n/),a=i.length,r=i[a-1].length+1;throw t+=" at line "+a+" col "+r+":\n\n  "+e.split(/\n/)[a-1]+"\n  "+Array(r).join(" ")+"^",new n(t)}function i(t,e,s,i){const a=e.split("\n"),r=Math.max(s-3,0),c=Math.min(a.length,s+3),l=i,o=a.slice(r,c).map(function(t,e){const n=e+r+1;return(n==s?" >> ":"    ")+n+"| "+t}).join("\n"),h=new n((l?l+":"+s+"\n":"line "+s+"\n")+o+"\n\n"+t.message);throw h.name=t.name,h}const a=async function(){}.constructor;function r(t,e){const s=this.config,i=e&&e.async?a:Function;try{return new i(s.varName,"options",this.compileToString.call(this,t,e))}catch(s){throw s instanceof SyntaxError?new n("Bad template syntax\n\n"+s.message+"\n"+Array(s.message.length+1).join("=")+"\n"+this.compileToString.call(this,t,e)+"\n"):s}}function c(t,e){const n=this.config,s=e&&e.async,i=this.compileBody,a=this.parse.call(this,t);let r=`${n.functionHeader}\nlet include = (template, data) => this.render(template, data, options);\nlet includeAsync = (template, data) => this.renderAsync(template, data, options);\n\nlet __eta = {res: "", e: this.config.escapeFunction, f: this.config.filterFunction${n.debug?', line: 1, templateStr: "'+t.replace(/\\|"/g,"\\$&").replace(/\r\n|\n|\r/g,"\\n")+'"':""}};\n\nfunction layout(path, data) {\n  __eta.layout = path;\n  __eta.layoutData = data;\n}${n.debug?"try {":""}${n.useWith?"with("+n.varName+"||{}){":""}\n\n${i.call(this,a)}\nif (__eta.layout) {\n  __eta.res = ${s?"await includeAsync":"include"} (__eta.layout, {...${n.varName}, body: __eta.res, ...__eta.layoutData});\n}\n${n.useWith?"}":""}${n.debug?"} catch (e) { this.RuntimeErr(e, __eta.templateStr, __eta.line, options.filepath) }":""}\nreturn __eta.res;\n`;if(n.plugins)for(let t=0;t<n.plugins.length;t++){const e=n.plugins[t];e.processFnString&&(r=e.processFnString(r,n))}return r}function l(t){const e=this.config;let n=0;const s=t.length;let i="";for(;n<s;n++){const s=t[n];if("string"==typeof s)i+="__eta.res+='"+s+"'\n";else{const t=s.t;let n=s.val||"";e.debug&&(i+="__eta.line="+s.lineNo+"\n"),"r"===t?(e.autoFilter&&(n="__eta.f("+n+")"),i+="__eta.res+="+n+"\n"):"i"===t?(e.autoFilter&&(n="__eta.f("+n+")"),e.autoEscape&&(n="__eta.e("+n+")"),i+="__eta.res+="+n+"\n"):"e"===t&&(i+=n+"\n")}}return i}const o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function h(t){return o[t]}const u={autoEscape:!0,autoFilter:!1,autoTrim:[!1,"nl"],cache:!1,cacheFilepaths:!0,debug:!1,escapeFunction:function(t){const e=String(t);return/[&<>"']/.test(e)?e.replace(/[&<>"']/g,h):e},filterFunction:t=>String(t),functionHeader:"",parse:{exec:"",interpolate:"=",raw:"~"},plugins:[],rmWhitespace:!1,tags:["<%","%>"],useWith:!1,varName:"it",defaultExtension:".eta"},p=/`(?:\\[\s\S]|\${(?:[^{}]|{(?:[^{}]|{[^}]*})*})*}|(?!\${)[^\\`])*`/g,g=/'(?:\\[\s\w"'\\`]|[^\n\r'\\])*?'/g,d=/"(?:\\[\s\w"'\\`]|[^\n\r"\\])*?"/g;function f(t){return t.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function m(t,e){return t.slice(0,e).split("\n").length}function y(t){const e=this.config;let n=[],i=!1,a=0;const r=e.parse;if(e.plugins)for(let n=0;n<e.plugins.length;n++){const s=e.plugins[n];s.processTemplate&&(t=s.processTemplate(t,e))}function c(t,s){t&&(t=function(t,e,n,s){let i,a;return Array.isArray(e.autoTrim)?(i=e.autoTrim[1],a=e.autoTrim[0]):i=a=e.autoTrim,(n||!1===n)&&(i=n),(s||!1===s)&&(a=s),a||i?"slurp"===i&&"slurp"===a?t.trim():("_"===i||"slurp"===i?t=t.trimStart():"-"!==i&&"nl"!==i||(t=t.replace(/^(?:\r\n|\n|\r)/,"")),"_"===a||"slurp"===a?t=t.trimEnd():"-"!==a&&"nl"!==a||(t=t.replace(/(?:\r\n|\n|\r)$/,"")),t):t}(t,e,i,s),t&&(t=t.replace(/\\|'/g,"\\$&").replace(/\r\n|\n|\r/g,"\\n"),n.push(t)))}e.rmWhitespace&&(t=t.replace(/[\r\n]+/g,"\n").replace(/^\s+|\s+$/gm,"")),p.lastIndex=0,g.lastIndex=0,d.lastIndex=0;const l=[r.exec,r.interpolate,r.raw].reduce(function(t,e){return t&&e?t+"|"+f(e):e?f(e):t},""),o=new RegExp(f(e.tags[0])+"(-|_)?\\s*("+l+")?\\s*","g"),h=new RegExp("'|\"|`|\\/\\*|(\\s*(-|_)?"+f(e.tags[1])+")","g");let u;for(;u=o.exec(t);){const l=t.slice(a,u.index);a=u[0].length+u.index;const f=u[2]||"";let y;c(l,u[1]),h.lastIndex=a;let x=!1;for(;y=h.exec(t);){if(y[1]){const e=t.slice(a,y.index);o.lastIndex=a=h.lastIndex,i=y[2],x={t:f===r.exec?"e":f===r.raw?"r":f===r.interpolate?"i":"",val:e};break}{const e=y[0];if("/*"===e){const e=t.indexOf("*/",h.lastIndex);-1===e&&s("unclosed comment",t,y.index),h.lastIndex=e}else"'"===e?(g.lastIndex=y.index,g.exec(t)?h.lastIndex=g.lastIndex:s("unclosed string",t,y.index)):'"'===e?(d.lastIndex=y.index,d.exec(t)?h.lastIndex=d.lastIndex:s("unclosed string",t,y.index)):"`"===e&&(p.lastIndex=y.index,p.exec(t)?h.lastIndex=p.lastIndex:s("unclosed string",t,y.index))}}x?(e.debug&&(x.lineNo=m(t,u.index)),n.push(x)):s("unclosed tag",t,u.index)}if(c(t.slice(a,t.length),!1),e.plugins)for(let t=0;t<e.plugins.length;t++){const s=e.plugins[t];s.processAST&&(n=s.processAST(n,e))}return n}function x(t,e){const s=e&&e.async?this.templatesAsync:this.templatesSync;if(this.resolvePath&&this.readFile&&!t.startsWith("@")){const t=e.filepath,n=s.get(t);if(this.config.cache&&n)return n;{const n=this.readFile(t),i=this.compile(n,e);return this.config.cache&&s.define(t,i),i}}{const e=s.get(t);if(e)return e;throw new n("Failed to get template '"+t+"'")}}function _(e,n,s){let i;const a=t({},s,{async:!1});return"string"==typeof e?(this.resolvePath&&this.readFile&&!e.startsWith("@")&&(a.filepath=this.resolvePath(e,a)),i=x.call(this,e,a)):i=e,i.call(this,n,a)}function w(e,n,s){let i;const a=t({},s,{async:!0});"string"==typeof e?(this.resolvePath&&this.readFile&&!e.startsWith("@")&&(a.filepath=this.resolvePath(e,a)),i=x.call(this,e,a)):i=e;const r=i.call(this,n,a);return Promise.resolve(r)}function S(t,e){const n=this.compile(t,{async:!1});return _.call(this,n,e)}function v(t,e){const n=this.compile(t,{async:!0});return w.call(this,n,e)}class F{constructor(n){this.config=void 0,this.RuntimeErr=i,this.compile=r,this.compileToString=c,this.compileBody=l,this.parse=y,this.render=_,this.renderAsync=w,this.renderString=S,this.renderStringAsync=v,this.filepathCache={},this.templatesSync=new e({}),this.templatesAsync=new e({}),this.resolvePath=null,this.readFile=null,this.config=n?t({},u,n):t({},u)}configure(e){this.config=t({},this.config,e)}withConfig(e){return t({},this,{config:t({},this.config,e)})}loadTemplate(t,e,n){if("string"==typeof e)(n&&n.async?this.templatesAsync:this.templatesSync).define(t,this.compile(e,n));else{let s=this.templatesSync;("AsyncFunction"===e.constructor.name||n&&n.async)&&(s=this.templatesAsync),s.define(t,e)}}}class I extends F{}export{I as Eta};
//# sourceMappingURL=browser.module.mjs.map
